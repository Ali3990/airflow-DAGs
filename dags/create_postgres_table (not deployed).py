# table_utils.py
from airflow.providers.postgres.hooks.postgres import PostgresHook

def create_table_if_not_exists(table_name: str):
    """
    Creates the target table in Postgres if it doesn't already exist.
    Modify the columns below as needed.
    """
    pg_hook = PostgresHook(postgres_conn_id="DBeaver_conn")
    create_table_sql = f"""
    CREATE TABLE IF NOT EXISTS {table_name} (
        LOCATION_AGGREGATE  VARCHAR(50), 
        LOCATION_CODE  VARCHAR(50), 
        TIME_PERIOD  VARCHAR(50), 
        LOCATION_CITY  VARCHAR(50), 
        LOCATION_COUNTY  VARCHAR(50), 
        LOCATION_CBSA  VARCHAR(50), 
        LOCATION_STATE  VARCHAR(50), 
        TOTAL_SALES  VARCHAR(50), 
        TOTAL_SALES_RESALE  VARCHAR(50), 
        TOTAL_SALES_NEW_CONST  VARCHAR(50), 
        TOTAL_AVG_SALES_PRICE  VARCHAR(50), 
        TOTAL_AVG_SALES_PRICE_RESALE  VARCHAR(50), 
        TOTAL_AVG_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        TOTAL_MED_SALES_PRICE  VARCHAR(50), 
        TOTAL_MED_SALES_PRICE_RESALE  VARCHAR(50), 
        TOTAL_MED_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        TOTAL_UPPER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        TOTAL_UPPER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        TOTAL_UPPER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        TOTAL_LOWER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        TOTAL_LOWER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        TOTAL_LOWER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        TOTAL_AVG_SQFT  VARCHAR(50), 
        TOTAL_AVG_SQFT_RESALE  VARCHAR(50), 
        TOTAL_AVG_SQFT_NEW_CONST  VARCHAR(50), 
        TOTAL_AVG_DOLLAR_PER_SQFT  VARCHAR(50), 
        TOTAL_AVG_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        TOTAL_AVG_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        TOTAL_MED_SQFT  VARCHAR(50), 
        TOTAL_MED_SQFT_RESALE  VARCHAR(50), 
        TOTAL_MED_SQFT_NEW_CONST  VARCHAR(50), 
        TOTAL_MED_DOLLAR_PER_SQFT  VARCHAR(50), 
        TOTAL_MED_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        TOTAL_MED_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        TOTAL_12_MONTH_PRICE_CHANGE  VARCHAR(50), 
        TOTAL_12_MONTH_PRICE_CHANGE_RESALE  VARCHAR(50), 
        TOTAL_12_MONTH_PRICE_CHANGE_NEW_CONST  VARCHAR(50), 
        TOTAL_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        TOTAL_NON_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        TOTAL_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        TOTAL_NON_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        TOTAL_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        TOTAL_NON_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_Under $250K  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$250K-$500K  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$500K-$750K  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$750K-$1M  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$1M-$1 5M  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$1 5M-$2 0M  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$2M-$3M  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_$3M-$5M  VARCHAR(50), 
        TOTAL_SALES_BY_PRICE_RANGE_Over $5M  VARCHAR(50), 
        CONDO_TOTAL_SALES  VARCHAR(50), 
        CONDO_TOTAL_SALES_RESALE  VARCHAR(50), 
        CONDO_TOTAL_SALES_NEW_CONST  VARCHAR(50), 
        CONDO_AVG_SALES_PRICE  VARCHAR(50), 
        CONDO_AVG_SALES_PRICE_RESALE  VARCHAR(50), 
        CONDO_AVG_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        CONDO_MED_SALES_PRICE  VARCHAR(50), 
        CONDO_MED_SALES_PRICE_RESALE  VARCHAR(50), 
        CONDO_MED_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        CONDO_UPPER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        CONDO_UPPER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        CONDO_UPPER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        CONDO_LOWER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        CONDO_LOWER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        CONDO_LOWER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        CONDO_AVG_SQFT  VARCHAR(50), 
        CONDO_AVG_SQFT_RESALE  VARCHAR(50), 
        CONDO_AVG_SQFT_NEW_CONST  VARCHAR(50), 
        CONDO_AVG_DOLLAR_PER_SQFT  VARCHAR(50), 
        CONDO_AVG_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        CONDO_AVG_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        CONDO_MED_SQFT  VARCHAR(50), 
        CONDO_MED_SQFT_RESALE  VARCHAR(50), 
        CONDO_MED_SQFT_NEW_CONST  VARCHAR(50), 
        CONDO_MED_DOLLAR_PER_SQFT  VARCHAR(50), 
        CONDO_MED_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        CONDO_MED_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        CONDO_12_MONTH_PRICE_CHANGE  VARCHAR(50), 
        CONDO_12_MONTH_PRICE_CHANGE_RESALE  VARCHAR(50), 
        CONDO_12_MONTH_PRICE_CHANGE_NEW_CONST  VARCHAR(50), 
        CONDO_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        CONDO_NON_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        CONDO_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        CONDO_NON_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        CONDO_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        CONDO_NON_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_Under $250K  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$250K-$500K  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$500K-$750K  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$750K-$1M  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$1M-$1 5M  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$1 5M-$2 0M  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$2M-$3M  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_$3M-$5M  VARCHAR(50), 
        CONDO_SALES_BY_PRICE_RANGE_Over $5M  VARCHAR(50), 
        SFR_ATTACHED_TOTAL_SALES  VARCHAR(50), 
        SFR_ATTACHED_TOTAL_SALES_RESALE  VARCHAR(50), 
        SFR_ATTACHED_TOTAL_SALES_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_AVG_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_AVG_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_ATTACHED_AVG_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_MED_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_MED_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_ATTACHED_MED_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_UPPER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_UPPER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_ATTACHED_UPPER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_LOWER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_LOWER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_ATTACHED_LOWER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_AVG_SQFT  VARCHAR(50), 
        SFR_ATTACHED_AVG_SQFT_RESALE  VARCHAR(50), 
        SFR_ATTACHED_AVG_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_AVG_DOLLAR_PER_SQFT  VARCHAR(50), 
        SFR_ATTACHED_AVG_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        SFR_ATTACHED_AVG_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_MED_SQFT  VARCHAR(50), 
        SFR_ATTACHED_MED_SQFT_RESALE  VARCHAR(50), 
        SFR_ATTACHED_MED_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_MED_DOLLAR_PER_SQFT  VARCHAR(50), 
        SFR_ATTACHED_MED_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        SFR_ATTACHED_MED_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_12_MONTH_PRICE_CHANGE  VARCHAR(50), 
        SFR_ATTACHED_12_MONTH_PRICE_CHANGE_RESALE  VARCHAR(50), 
        SFR_ATTACHED_12_MONTH_PRICE_CHANGE_NEW_CONST  VARCHAR(50), 
        SFR_ATTACHED_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        SFR_ATTACHED_NON_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        SFR_ATTACHED_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_NON_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_NON_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_Under $250K  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$250K-$500K  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$500K-$750K  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$750K-$1M  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$1M-$1 5M  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$1 5M-$2 0M  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$2M-$3M  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_$3M-$5M  VARCHAR(50), 
        SFR_ATTACHED_SALES_BY_PRICE_RANGE_Over $5M  VARCHAR(50), 
        SFR_DETACHED_TOTAL_SALES  VARCHAR(50), 
        SFR_DETACHED_TOTAL_SALES_RESALE  VARCHAR(50), 
        SFR_DETACHED_TOTAL_SALES_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_AVG_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_AVG_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_DETACHED_AVG_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_MED_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_MED_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_DETACHED_MED_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_UPPER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_UPPER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_DETACHED_UPPER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_LOWER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_LOWER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        SFR_DETACHED_LOWER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_AVG_SQFT  VARCHAR(50), 
        SFR_DETACHED_AVG_SQFT_RESALE  VARCHAR(50), 
        SFR_DETACHED_AVG_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_AVG_DOLLAR_PER_SQFT  VARCHAR(50), 
        SFR_DETACHED_AVG_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        SFR_DETACHED_AVG_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_MED_SQFT  VARCHAR(50), 
        SFR_DETACHED_MED_SQFT_RESALE  VARCHAR(50), 
        SFR_DETACHED_MED_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_MED_DOLLAR_PER_SQFT  VARCHAR(50), 
        SFR_DETACHED_MED_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        SFR_DETACHED_MED_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_12_MONTH_PRICE_CHANGE  VARCHAR(50), 
        SFR_DETACHED_12_MONTH_PRICE_CHANGE_RESALE  VARCHAR(50), 
        SFR_DETACHED_12_MONTH_PRICE_CHANGE_NEW_CONST  VARCHAR(50), 
        SFR_DETACHED_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        SFR_DETACHED_NON_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        SFR_DETACHED_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_NON_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_NON_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_Under $250K  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$250K-$500K  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$500K-$750K  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$750K-$1M  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$1M-$1 5M  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$1 5M-$2 0M  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$2M-$3M  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_$3M-$5M  VARCHAR(50), 
        SFR_DETACHED_SALES_BY_PRICE_RANGE_Over $5M  VARCHAR(50), 
        MULTI_FAMILY_TOTAL_SALES  VARCHAR(50), 
        MULTI_FAMILY_TOTAL_SALES_RESALE  VARCHAR(50), 
        MULTI_FAMILY_TOTAL_SALES_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_AVG_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_AVG_SALES_PRICE_RESALE  VARCHAR(50), 
        MULTI_FAMILY_AVG_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_MED_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_MED_SALES_PRICE_RESALE  VARCHAR(50), 
        MULTI_FAMILY_MED_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_UPPER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_UPPER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        MULTI_FAMILY_UPPER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_LOWER_QUARTILE_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_LOWER_QUARTILE_SALES_PRICE_RESALE  VARCHAR(50), 
        MULTI_FAMILY_LOWER_QUARTILE_SALES_PRICE_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_AVG_SQFT  VARCHAR(50), 
        MULTI_FAMILY_AVG_SQFT_RESALE  VARCHAR(50), 
        MULTI_FAMILY_AVG_SQFT_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_AVG_DOLLAR_PER_SQFT  VARCHAR(50), 
        MULTI_FAMILY_AVG_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        MULTI_FAMILY_AVG_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_MED_SQFT  VARCHAR(50), 
        MULTI_FAMILY_MED_SQFT_RESALE  VARCHAR(50), 
        MULTI_FAMILY_MED_SQFT_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_MED_DOLLAR_PER_SQFT  VARCHAR(50), 
        MULTI_FAMILY_MED_DOLLAR_PER_SQFT_RESALE  VARCHAR(50), 
        MULTI_FAMILY_MED_DOLLAR_PER_SQFT_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_12_MONTH_PRICE_CHANGE  VARCHAR(50), 
        MULTI_FAMILY_12_MONTH_PRICE_CHANGE_RESALE  VARCHAR(50), 
        MULTI_FAMILY_12_MONTH_PRICE_CHANGE_NEW_CONST  VARCHAR(50), 
        MULTI_FAMILY_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        MULTI_FAMILY_NON_OWNER_OCCUPIED_SALES  VARCHAR(50), 
        MULTI_FAMILY_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_NON_OWNER_OCCUPIED_AVG_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_NON_OWNER_OCCUPIED_MED_SALES_PRICE  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_Under $250K  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$250K-$500K  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$500K-$750K  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$750K-$1M  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$1M-$1 5M  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$1 5M-$2 0M  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$2M-$3M  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_$3M-$5M  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_Over $5M  VARCHAR(50), 
        MULTI_FAMILY_SALES_BY_PRICE_RANGE_Over $5M]  VARCHAR(50)


    );
    """
    pg_hook.run(create_table_sql)
