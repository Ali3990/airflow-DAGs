{"timestamp":"2025-08-22T19:04:34.875686","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-22T19:04:34.876451","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/sftp_to_postgres.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-22T19:04:35.305687Z","level":"info","event":"ðŸŽ¯ Latest month detected in SFTP files: 202508","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-22T19:04:35.313723","level":"info","event":"Connection Retrieved 'sftp_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-22T19:04:35.314162","level":"warning","event":"No Host Key Verification. This won't protect against Man-In-The-Middle attacks","logger":"airflow.task.hooks.airflow.providers.sftp.hooks.sftp.SFTPHook"}
{"timestamp":"2025-08-22T19:04:35.558115","level":"info","event":"Connected (version 2.0, client 1.82_sshlib)","logger":"paramiko.transport"}
{"timestamp":"2025-08-22T19:04:35.731490","level":"info","event":"Auth banner: b'If you experience issues connecting to ftp2.resftp.com site please contact customer support at 866-440-7449'","logger":"paramiko.transport"}
{"timestamp":"2025-08-22T19:04:35.785995","level":"info","event":"Authentication (password) successful!","logger":"paramiko.transport"}
{"timestamp":"2025-08-22T19:04:35.891317","level":"info","event":"[chan 0] Opened sftp connection (server version 3)","logger":"paramiko.transport.sftp"}
{"timestamp":"2025-08-22T19:04:47.029280","level":"info","event":"[chan 0] sftp session closed.","logger":"paramiko.transport.sftp"}
{"timestamp":"2025-08-22T19:04:47.029996Z","level":"info","event":"âœ… Downloaded Marcus&Millichap_0000757_NationwideHomeSalesReport_Delivery_20250801.zip â†’ /tmp/sftp_downloads/Marcus&Millichap_0000757_NationwideHomeSalesReport_Delivery_20250801.zip","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-22T19:05:26.247178","level":"warning","event":"/opt/airflow/dags/sftp_to_postgres.py:87: DtypeWarning: Columns (15,18,21,25,26,27,31,32,33,57,60,63,66,70,71,72,76,77,78,102,105,108,111,115,116,117,121,122,123,160,161,162,166,167,168,190,191,192,193,194,195,196,197,198,199,200,201,205,206,207,211,212,213,219,220,221,222) have mixed types. Specify dtype option on import or set low_memory=False.\n  df = pd.read_csv(txt_path, sep=\"|\")  # pipe-delimited\n","logger":"py.warnings"}
{"timestamp":"2025-08-22T19:05:44.457551Z","level":"info","event":"Uploading Marcus&Millichap_0000757_NationwideHomeSalesReport_Delivery_20250801.txt, shape=(1396437, 232), columns=['LOCATION_AGGREGATE', 'LOCATION_CODE', 'TIME_PERIOD', 'LOCATION_CITY', 'LOCATION_COUNTY', 'LOCATION_CBSA', 'LOCATION_STATE', 'TOTAL_SALES', 'TOTAL_SALES_RESALE', 'TOTAL_SALES_NEW_CONST', 'TOTAL_AVG_SALES_PRICE', 'TOTAL_AVG_SALES_PRICE_RESALE', 'TOTAL_AVG_SALES_PRICE_NEW_CONST', 'TOTAL_MED_SALES_PRICE', 'TOTAL_MED_SALES_PRICE_RESALE', 'TOTAL_MED_SALES_PRICE_NEW_CONST', 'TOTAL_UPPER_QUARTILE_SALES_PRICE', 'TOTAL_UPPER_QUARTILE_SALES_PRICE_RESALE', 'TOTAL_UPPER_QUARTILE_SALES_PRICE_NEW_CONST', 'TOTAL_LOWER_QUARTILE_SALES_PRICE', 'TOTAL_LOWER_QUARTILE_SALES_PRICE_RESALE', 'TOTAL_LOWER_QUARTILE_SALES_PRICE_NEW_CONST', 'TOTAL_AVG_SQFT', 'TOTAL_AVG_SQFT_RESALE', 'TOTAL_AVG_SQFT_NEW_CONST', 'TOTAL_AVG_DOLLAR_PER_SQFT', 'TOTAL_AVG_DOLLAR_PER_SQFT_RESALE', 'TOTAL_AVG_DOLLAR_PER_SQFT_NEW_CONST', 'TOTAL_MED_SQFT', 'TOTAL_MED_SQFT_RESALE', 'TOTAL_MED_SQFT_NEW_CONST', 'TOTAL_MED_DOLLAR_PER_SQFT', 'TOTAL_MED_DOLLAR_PER_SQFT_RESALE', 'TOTAL_MED_DOLLAR_PER_SQFT_NEW_CONST', 'TOTAL_12_MONTH_PRICE_CHANGE', 'TOTAL_12_MONTH_PRICE_CHANGE_RESALE', 'TOTAL_12_MONTH_PRICE_CHANGE_NEW_CONST', 'TOTAL_OWNER_OCCUPIED_SALES', 'TOTAL_NON_OWNER_OCCUPIED_SALES', 'TOTAL_OWNER_OCCUPIED_AVG_SALES_PRICE', 'TOTAL_NON_OWNER_OCCUPIED_AVG_SALES_PRICE', 'TOTAL_OWNER_OCCUPIED_MED_SALES_PRICE', 'TOTAL_NON_OWNER_OCCUPIED_MED_SALES_PRICE', 'TOTAL_SALES_BY_PRICE_RANGE_Under $250K', 'TOTAL_SALES_BY_PRICE_RANGE_$250K-$500K', 'TOTAL_SALES_BY_PRICE_RANGE_$500K-$750K', 'TOTAL_SALES_BY_PRICE_RANGE_$750K-$1M', 'TOTAL_SALES_BY_PRICE_RANGE_$1M-$1.5M', 'TOTAL_SALES_BY_PRICE_RANGE_$1.5M-$2.0M', 'TOTAL_SALES_BY_PRICE_RANGE_$2M-$3M', 'TOTAL_SALES_BY_PRICE_RANGE_$3M-$5M', 'TOTAL_SALES_BY_PRICE_RANGE_Over $5M', 'CONDO_TOTAL_SALES', 'CONDO_TOTAL_SALES_RESALE', 'CONDO_TOTAL_SALES_NEW_CONST', 'CONDO_AVG_SALES_PRICE', 'CONDO_AVG_SALES_PRICE_RESALE', 'CONDO_AVG_SALES_PRICE_NEW_CONST', 'CONDO_MED_SALES_PRICE', 'CONDO_MED_SALES_PRICE_RESALE', 'CONDO_MED_SALES_PRICE_NEW_CONST', 'CONDO_UPPER_QUARTILE_SALES_PRICE', 'CONDO_UPPER_QUARTILE_SALES_PRICE_RESALE', 'CONDO_UPPER_QUARTILE_SALES_PRICE_NEW_CONST', 'CONDO_LOWER_QUARTILE_SALES_PRICE', 'CONDO_LOWER_QUARTILE_SALES_PRICE_RESALE', 'CONDO_LOWER_QUARTILE_SALES_PRICE_NEW_CONST', 'CONDO_AVG_SQFT', 'CONDO_AVG_SQFT_RESALE', 'CONDO_AVG_SQFT_NEW_CONST', 'CONDO_AVG_DOLLAR_PER_SQFT', 'CONDO_AVG_DOLLAR_PER_SQFT_RESALE', 'CONDO_AVG_DOLLAR_PER_SQFT_NEW_CONST', 'CONDO_MED_SQFT', 'CONDO_MED_SQFT_RESALE', 'CONDO_MED_SQFT_NEW_CONST', 'CONDO_MED_DOLLAR_PER_SQFT', 'CONDO_MED_DOLLAR_PER_SQFT_RESALE', 'CONDO_MED_DOLLAR_PER_SQFT_NEW_CONST', 'CONDO_12_MONTH_PRICE_CHANGE', 'CONDO_12_MONTH_PRICE_CHANGE_RESALE', 'CONDO_12_MONTH_PRICE_CHANGE_NEW_CONST', 'CONDO_OWNER_OCCUPIED_SALES', 'CONDO_NON_OWNER_OCCUPIED_SALES', 'CONDO_OWNER_OCCUPIED_AVG_SALES_PRICE', 'CONDO_NON_OWNER_OCCUPIED_AVG_SALES_PRICE', 'CONDO_OWNER_OCCUPIED_MED_SALES_PRICE', 'CONDO_NON_OWNER_OCCUPIED_MED_SALES_PRICE', 'CONDO_SALES_BY_PRICE_RANGE_Under $250K', 'CONDO_SALES_BY_PRICE_RANGE_$250K-$500K', 'CONDO_SALES_BY_PRICE_RANGE_$500K-$750K', 'CONDO_SALES_BY_PRICE_RANGE_$750K-$1M', 'CONDO_SALES_BY_PRICE_RANGE_$1M-$1.5M', 'CONDO_SALES_BY_PRICE_RANGE_$1.5M-$2.0M', 'CONDO_SALES_BY_PRICE_RANGE_$2M-$3M', 'CONDO_SALES_BY_PRICE_RANGE_$3M-$5M', 'CONDO_SALES_BY_PRICE_RANGE_Over $5M', 'SFR_ATTACHED_TOTAL_SALES', 'SFR_ATTACHED_TOTAL_SALES_RESALE', 'SFR_ATTACHED_TOTAL_SALES_NEW_CONST', 'SFR_ATTACHED_AVG_SALES_PRICE', 'SFR_ATTACHED_AVG_SALES_PRICE_RESALE', 'SFR_ATTACHED_AVG_SALES_PRICE_NEW_CONST', 'SFR_ATTACHED_MED_SALES_PRICE', 'SFR_ATTACHED_MED_SALES_PRICE_RESALE', 'SFR_ATTACHED_MED_SALES_PRICE_NEW_CONST', 'SFR_ATTACHED_UPPER_QUARTILE_SALES_PRICE', 'SFR_ATTACHED_UPPER_QUARTILE_SALES_PRICE_RESALE', 'SFR_ATTACHED_UPPER_QUARTILE_SALES_PRICE_NEW_CONST', 'SFR_ATTACHED_LOWER_QUARTILE_SALES_PRICE', 'SFR_ATTACHED_LOWER_QUARTILE_SALES_PRICE_RESALE', 'SFR_ATTACHED_LOWER_QUARTILE_SALES_PRICE_NEW_CONST', 'SFR_ATTACHED_AVG_SQFT', 'SFR_ATTACHED_AVG_SQFT_RESALE', 'SFR_ATTACHED_AVG_SQFT_NEW_CONST', 'SFR_ATTACHED_AVG_DOLLAR_PER_SQFT', 'SFR_ATTACHED_AVG_DOLLAR_PER_SQFT_RESALE', 'SFR_ATTACHED_AVG_DOLLAR_PER_SQFT_NEW_CONST', 'SFR_ATTACHED_MED_SQFT', 'SFR_ATTACHED_MED_SQFT_RESALE', 'SFR_ATTACHED_MED_SQFT_NEW_CONST', 'SFR_ATTACHED_MED_DOLLAR_PER_SQFT', 'SFR_ATTACHED_MED_DOLLAR_PER_SQFT_RESALE', 'SFR_ATTACHED_MED_DOLLAR_PER_SQFT_NEW_CONST', 'SFR_ATTACHED_12_MONTH_PRICE_CHANGE', 'SFR_ATTACHED_12_MONTH_PRICE_CHANGE_RESALE', 'SFR_ATTACHED_12_MONTH_PRICE_CHANGE_NEW_CONST', 'SFR_ATTACHED_OWNER_OCCUPIED_SALES', 'SFR_ATTACHED_NON_OWNER_OCCUPIED_SALES', 'SFR_ATTACHED_OWNER_OCCUPIED_AVG_SALES_PRICE', 'SFR_ATTACHED_NON_OWNER_OCCUPIED_AVG_SALES_PRICE', 'SFR_ATTACHED_OWNER_OCCUPIED_MED_SALES_PRICE', 'SFR_ATTACHED_NON_OWNER_OCCUPIED_MED_SALES_PRICE', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_Under $250K', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$250K-$500K', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$500K-$750K', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$750K-$1M', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$1M-$1 5M', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$1 5M-$2 0M', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$2M-$3M', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_$3M-$5M', 'SFR_ATTACHED_SALES_BY_PRICE_RANGE_Over $5M', 'SFR_DETACHED_TOTAL_SALES', 'SFR_DETACHED_TOTAL_SALES_RESALE', 'SFR_DETACHED_TOTAL_SALES_NEW_CONST', 'SFR_DETACHED_AVG_SALES_PRICE', 'SFR_DETACHED_AVG_SALES_PRICE_RESALE', 'SFR_DETACHED_AVG_SALES_PRICE_NEW_CONST', 'SFR_DETACHED_MED_SALES_PRICE', 'SFR_DETACHED_MED_SALES_PRICE_RESALE', 'SFR_DETACHED_MED_SALES_PRICE_NEW_CONST', 'SFR_DETACHED_UPPER_QUARTILE_SALES_PRICE', 'SFR_DETACHED_UPPER_QUARTILE_SALES_PRICE_RESALE', 'SFR_DETACHED_UPPER_QUARTILE_SALES_PRICE_NEW_CONST', 'SFR_DETACHED_LOWER_QUARTILE_SALES_PRICE', 'SFR_DETACHED_LOWER_QUARTILE_SALES_PRICE_RESALE', 'SFR_DETACHED_LOWER_QUARTILE_SALES_PRICE_NEW_CONST', 'SFR_DETACHED_AVG_SQFT', 'SFR_DETACHED_AVG_SQFT_RESALE', 'SFR_DETACHED_AVG_SQFT_NEW_CONST', 'SFR_DETACHED_AVG_DOLLAR_PER_SQFT', 'SFR_DETACHED_AVG_DOLLAR_PER_SQFT_RESALE', 'SFR_DETACHED_AVG_DOLLAR_PER_SQFT_NEW_CONST', 'SFR_DETACHED_MED_SQFT', 'SFR_DETACHED_MED_SQFT_RESALE', 'SFR_DETACHED_MED_SQFT_NEW_CONST', 'SFR_DETACHED_MED_DOLLAR_PER_SQFT', 'SFR_DETACHED_MED_DOLLAR_PER_SQFT_RESALE', 'SFR_DETACHED_MED_DOLLAR_PER_SQFT_NEW_CONST', 'SFR_DETACHED_12_MONTH_PRICE_CHANGE', 'SFR_DETACHED_12_MONTH_PRICE_CHANGE_RESALE', 'SFR_DETACHED_12_MONTH_PRICE_CHANGE_NEW_CONST', 'SFR_DETACHED_OWNER_OCCUPIED_SALES', 'SFR_DETACHED_NON_OWNER_OCCUPIED_SALES', 'SFR_DETACHED_OWNER_OCCUPIED_AVG_SALES_PRICE', 'SFR_DETACHED_NON_OWNER_OCCUPIED_AVG_SALES_PRICE', 'SFR_DETACHED_OWNER_OCCUPIED_MED_SALES_PRICE', 'SFR_DETACHED_NON_OWNER_OCCUPIED_MED_SALES_PRICE', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_Under $250K', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$250K-$500K', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$500K-$750K', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$750K-$1M', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$1M-$1.5M', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$1.5M-$2.0M', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$2M-$3M', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_$3M-$5M', 'SFR_DETACHED_SALES_BY_PRICE_RANGE_Over $5M', 'MULTI_FAMILY_TOTAL_SALES', 'MULTI_FAMILY_TOTAL_SALES_RESALE', 'MULTI_FAMILY_TOTAL_SALES_NEW_CONST', 'MULTI_FAMILY_AVG_SALES_PRICE', 'MULTI_FAMILY_AVG_SALES_PRICE_RESALE', 'MULTI_FAMILY_AVG_SALES_PRICE_NEW_CONST', 'MULTI_FAMILY_MED_SALES_PRICE', 'MULTI_FAMILY_MED_SALES_PRICE_RESALE', 'MULTI_FAMILY_MED_SALES_PRICE_NEW_CONST', 'MULTI_FAMILY_UPPER_QUARTILE_SALES_PRICE', 'MULTI_FAMILY_UPPER_QUARTILE_SALES_PRICE_RESALE', 'MULTI_FAMILY_UPPER_QUARTILE_SALES_PRICE_NEW_CONST', 'MULTI_FAMILY_LOWER_QUARTILE_SALES_PRICE', 'MULTI_FAMILY_LOWER_QUARTILE_SALES_PRICE_RESALE', 'MULTI_FAMILY_LOWER_QUARTILE_SALES_PRICE_NEW_CONST', 'MULTI_FAMILY_AVG_SQFT', 'MULTI_FAMILY_AVG_SQFT_RESALE', 'MULTI_FAMILY_AVG_SQFT_NEW_CONST', 'MULTI_FAMILY_AVG_DOLLAR_PER_SQFT', 'MULTI_FAMILY_AVG_DOLLAR_PER_SQFT_RESALE', 'MULTI_FAMILY_AVG_DOLLAR_PER_SQFT_NEW_CONST', 'MULTI_FAMILY_MED_SQFT', 'MULTI_FAMILY_MED_SQFT_RESALE', 'MULTI_FAMILY_MED_SQFT_NEW_CONST', 'MULTI_FAMILY_MED_DOLLAR_PER_SQFT', 'MULTI_FAMILY_MED_DOLLAR_PER_SQFT_RESALE', 'MULTI_FAMILY_MED_DOLLAR_PER_SQFT_NEW_CONST', 'MULTI_FAMILY_12_MONTH_PRICE_CHANGE', 'MULTI_FAMILY_12_MONTH_PRICE_CHANGE_RESALE', 'MULTI_FAMILY_12_MONTH_PRICE_CHANGE_NEW_CONST', 'MULTI_FAMILY_OWNER_OCCUPIED_SALES', 'MULTI_FAMILY_NON_OWNER_OCCUPIED_SALES', 'MULTI_FAMILY_OWNER_OCCUPIED_AVG_SALES_PRICE', 'MULTI_FAMILY_NON_OWNER_OCCUPIED_AVG_SALES_PRICE', 'MULTI_FAMILY_OWNER_OCCUPIED_MED_SALES_PRICE', 'MULTI_FAMILY_NON_OWNER_OCCUPIED_MED_SALES_PRICE', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_Under $250K', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$250K-$500K', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$500K-$750K', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$750K-$1M', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$1M-$1.5M', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$1.5M-$2.0M', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$2M-$3M', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_$3M-$5M', 'MULTI_FAMILY_SALES_BY_PRICE_RANGE_Over $5M']","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-22T19:06:14.084932","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"AirflowNotFoundException","exc_value":"The conn_id `postgres_conn` isn't defined","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":877,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1164,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":251,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":217,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":240,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/sftp_to_postgres.py","lineno":89,"name":"download_and_upload"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":913,"name":"insert_rows"},{"filename":"/usr/local/lib/python3.12/contextlib.py","lineno":137,"name":"__enter__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":874,"name":"_create_autocommit_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/postgres/hooks/postgres.py","lineno":153,"name":"get_conn"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":247,"name":"connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py","lineno":64,"name":"get_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py","lineno":482,"name":"get_connection_from_secrets"}],"is_group":false,"exceptions":[]},{"exc_type":"AirflowRuntimeError","exc_value":"CONNECTION_NOT_FOUND: {'conn_id': 'postgres_conn'}","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py","lineno":472,"name":"get_connection_from_secrets"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/connection.py","lineno":142,"name":"get"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/context.py","lineno":158,"name":"_get_connection"}],"is_group":false,"exceptions":[]}]}
